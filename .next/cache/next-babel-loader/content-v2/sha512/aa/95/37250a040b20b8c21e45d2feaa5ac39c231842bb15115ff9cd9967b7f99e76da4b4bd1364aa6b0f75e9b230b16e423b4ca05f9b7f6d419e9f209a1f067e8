{"ast":null,"code":"import _defineProperty from \"/home/hao/Deadline/mhhpm_18_3_final/FE-KTXSHOP-SELLER/node_modules/next/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _toConsumableArray from \"/home/hao/Deadline/mhhpm_18_3_final/FE-KTXSHOP-SELLER/node_modules/next/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _regeneratorRuntime from \"/home/hao/Deadline/mhhpm_18_3_final/FE-KTXSHOP-SELLER/node_modules/next/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/home/hao/Deadline/mhhpm_18_3_final/FE-KTXSHOP-SELLER/node_modules/next/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\n\nvar _jsxFileName = \"/home/hao/Deadline/mhhpm_18_3_final/FE-KTXSHOP-SELLER/pages/cms/order/index.js\",\n    _s = $RefreshSig$();\n\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { useEffect, useState } from \"react\";\nimport Head from \"next/head\";\nimport Link from \"next/link\";\nimport Router, { useRouter } from \"next/router\";\nimport MyTablePagination from \"../../../component/my-pagination/my-pagination\";\nimport { useForm } from \"react-hook-form\";\nimport { Button, Paper, Table, TableBody, TableCell, TableContainer, TableHead, TableRow, Tooltip } from \"@material-ui/core\";\nimport { faPlus } from \"@fortawesome/free-solid-svg-icons\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport IconButton from '@material-ui/core/IconButton';\nimport InputBase from '@material-ui/core/InputBase';\nimport EditIcon from '@material-ui/icons/Edit';\nimport DeleteIcon from '@material-ui/icons/Delete';\nimport SearchIcon from '@material-ui/icons/Search';\nimport { MyCard, MyCardActions, MyCardHeader } from \"../../../component/my-card/my-card\";\nimport { renderWithLoggedInUser } from \"../../../lib/login\";\nimport styles from \"./order.module.css\";\nimport { formatTime } from \"../../../utils/func\";\nexport var __N_SSP = true;\nexport function loadOrderData(_x) {\n  return _loadOrderData.apply(this, arguments);\n}\n\nfunction _loadOrderData() {\n  _loadOrderData = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3(ctx) {\n    var data;\n    return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n      while (1) {\n        switch (_context3.prev = _context3.next) {\n          case 0:\n            // setup data\n            data = {\n              props: {\n                data: []\n              }\n            };\n            _context3.next = 3;\n            return fetch(process.env.API_HOST + '/api/orders').then(function (response) {\n              return response.json();\n            }).then(function (res) {\n              data.props.count = res.meta.pagination.total;\n              res.data.map(function (item) {\n                data.props.data.push(_objectSpread(_objectSpread({}, item.attributes), {}, {\n                  id: item.id\n                }));\n              });\n            });\n\n          case 3:\n            return _context3.abrupt(\"return\", data);\n\n          case 4:\n          case \"end\":\n            return _context3.stop();\n        }\n      }\n    }, _callee3);\n  }));\n  return _loadOrderData.apply(this, arguments);\n}\n\nexport default function OrderPage(props) {\n  return renderWithLoggedInUser(props, render);\n}\n_c = OrderPage;\n\nfunction render(props) {\n  _s();\n\n  var _data$data,\n      _data$data2,\n      _this = this;\n\n  var _useForm = useForm(),\n      register = _useForm.register,\n      handleSubmit = _useForm.handleSubmit,\n      errors = _useForm.errors;\n\n  var router = useRouter();\n\n  var _useState = useState(props),\n      data = _useState[0],\n      setData = _useState[1];\n\n  var _useState2 = useState(''),\n      search = _useState2[0],\n      setSearch = _useState2[1];\n\n  useEffect(function () {\n    setData(props);\n    setSearch(typeof router.query.search === 'undefined' ? '' : q);\n  }, [props]);\n  var page = parseInt(router.query.page) || 0;\n  var limit = parseInt(router.query.limit) || 20;\n  var q = router.query.search || '';\n\n  function handleChange(_x2) {\n    return _handleChange.apply(this, arguments);\n  }\n\n  function _handleChange() {\n    _handleChange = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(event) {\n      var value;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              value = event.target.value;\n              setSearch(value);\n\n            case 2:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n    return _handleChange.apply(this, arguments);\n  }\n\n  function onSearch(formData) {\n    try {\n      q = formatUrlSearch(search);\n      Router.push(\"/cms/order?search=\".concat(q));\n    } catch (error) {\n      console.log(error);\n    }\n  }\n\n  function deleteOrder(_x3) {\n    return _deleteOrder.apply(this, arguments);\n  }\n\n  function _deleteOrder() {\n    _deleteOrder = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(id) {\n      var orderList;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.next = 2;\n              return fetch(process.env.API_HOST + \"/api/orders/\" + id, {\n                method: 'DELETE'\n              }).then(function (response) {\n                return response.json();\n              }).then(function (res) {\n                return console.log(res);\n              });\n\n            case 2:\n              orderList = _toConsumableArray(data.data);\n              setData({\n                data: orderList.filter(function (v) {\n                  return v.id != id;\n                }),\n                count: data.count - 1\n              });\n\n            case 4:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n    return _deleteOrder.apply(this, arguments);\n  }\n\n  return __jsx(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 9\n    }\n  }, __jsx(Head, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 87,\n      columnNumber: 13\n    }\n  }, __jsx(\"title\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 17\n    }\n  }, \"Danh s\\xE1ch h\\xF3a \\u0111\\u01A1n\")), __jsx(MyCard, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 13\n    }\n  }, __jsx(MyCardHeader, {\n    title: \"Danh s\\xE1ch h\\xF3a \\u0111\\u01A1n\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 17\n    }\n  }, __jsx(Link, {\n    href: \"/cms/order/new\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 21\n    }\n  }, __jsx(Button, {\n    variant: \"contained\",\n    color: \"primary\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 25\n    }\n  }, __jsx(FontAwesomeIcon, {\n    icon: faPlus,\n    style: {\n      marginRight: 8\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 29\n    }\n  }), \"  Th\\xEAm h\\xF3a \\u0111\\u01A1n\"))), __jsx(MyCardActions, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 17\n    }\n  }, __jsx(Paper, {\n    className: styles.search,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 21\n    }\n  }, __jsx(InputBase, {\n    id: \"q\",\n    name: \"q\",\n    className: styles.input,\n    value: search,\n    autoComplete: \"off\",\n    onChange: handleChange,\n    inputRef: register,\n    onKeyPress: function onKeyPress(event) {\n      if (event.key === 'Enter') {\n        onSearch();\n      }\n    },\n    placeholder: \"Nh\\u1EADp t\\xEAn h\\xF3a \\u0111\\u01A1n\",\n    inputProps: {\n      'aria-label': 'Nhập tên hóa đơn'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 100,\n      columnNumber: 25\n    }\n  }), __jsx(IconButton, {\n    className: styles.iconButton,\n    \"aria-label\": \"search\",\n    onClick: onSearch,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 116,\n      columnNumber: 25\n    }\n  }, __jsx(SearchIcon, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 118,\n      columnNumber: 29\n    }\n  })))), __jsx(TableContainer, {\n    component: Paper,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 122,\n      columnNumber: 17\n    }\n  }, __jsx(Table, {\n    size: \"small\",\n    \"aria-label\": \"a dense table\",\n    style: {\n      tableLayout: 'fixed'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 123,\n      columnNumber: 21\n    }\n  }, __jsx(\"colgroup\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 124,\n      columnNumber: 25\n    }\n  }, __jsx(\"col\", {\n    width: \"15%\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 125,\n      columnNumber: 29\n    }\n  }), __jsx(\"col\", {\n    width: \"15%\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 126,\n      columnNumber: 29\n    }\n  }), __jsx(\"col\", {\n    width: \"15%\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 127,\n      columnNumber: 29\n    }\n  }), __jsx(\"col\", {\n    width: \"15%\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 128,\n      columnNumber: 29\n    }\n  }), __jsx(\"col\", {\n    width: \"15%\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 129,\n      columnNumber: 29\n    }\n  }), __jsx(\"col\", {\n    width: \"15%\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 130,\n      columnNumber: 29\n    }\n  }), __jsx(\"col\", {\n    width: \"10%\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 131,\n      columnNumber: 29\n    }\n  })), __jsx(TableHead, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 133,\n      columnNumber: 25\n    }\n  }, __jsx(TableRow, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 134,\n      columnNumber: 29\n    }\n  }, __jsx(TableCell, {\n    align: \"left\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 135,\n      columnNumber: 33\n    }\n  }, \"ID\"), __jsx(TableCell, {\n    align: \"left\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 136,\n      columnNumber: 33\n    }\n  }, \"ProductID\"), __jsx(TableCell, {\n    align: \"left\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 137,\n      columnNumber: 33\n    }\n  }, \"S\\u1ED1 l\\u01B0\\u1EE3ng\"), __jsx(TableCell, {\n    align: \"left\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 138,\n      columnNumber: 33\n    }\n  }, \"Th\\u1EDDi gian t\\u1EA1o\"), __jsx(TableCell, {\n    align: \"left\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 139,\n      columnNumber: 33\n    }\n  }, \" T\\u1ED5ng ti\\u1EC1n \"), __jsx(TableCell, {\n    align: \"left\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 140,\n      columnNumber: 33\n    }\n  }, \" Tr\\u1EA1ng th\\xE1i \"), __jsx(TableCell, {\n    align: \"center\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 141,\n      columnNumber: 33\n    }\n  }, \"Thao t\\xE1c\"))), ((_data$data = data.data) === null || _data$data === void 0 ? void 0 : _data$data.length) > 0 ? __jsx(React.Fragment, null, __jsx(TableBody, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 146,\n      columnNumber: 33\n    }\n  }, (_data$data2 = data.data) === null || _data$data2 === void 0 ? void 0 : _data$data2.map(function (row) {\n    return __jsx(TableRow, {\n      key: row.id,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 148,\n        columnNumber: 41\n      }\n    }, __jsx(TableCell, {\n      align: \"left\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 149,\n        columnNumber: 45\n      }\n    }, row.id), __jsx(TableCell, {\n      align: \"left\",\n      className: styles.overflowWrap,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 152,\n        columnNumber: 45\n      }\n    }, row.ProductID), __jsx(TableCell, {\n      align: \"left\",\n      className: styles.overflowWrap,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 155,\n        columnNumber: 45\n      }\n    }, row.Quantity), __jsx(TableCell, {\n      align: \"left\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 158,\n        columnNumber: 45\n      }\n    }, row.PurchaseDate), __jsx(TableCell, {\n      align: \"left\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 159,\n        columnNumber: 45\n      }\n    }, row.Subtotal, \"vn\\u0111\"), __jsx(TableCell, {\n      align: \"left\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 160,\n        columnNumber: 45\n      }\n    }, row.Status), __jsx(TableCell, {\n      align: \"center\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 161,\n        columnNumber: 45\n      }\n    }, __jsx(Link, {\n      href: \"/cms/order/edit?orderId=\".concat(row.id),\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 162,\n        columnNumber: 49\n      }\n    }, __jsx(\"a\", {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 163,\n        columnNumber: 53\n      }\n    }, __jsx(Tooltip, {\n      title: \"C\\u1EADp nh\\u1EADt th\\xF4ng tin\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 164,\n        columnNumber: 57\n      }\n    }, __jsx(IconButton, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 165,\n        columnNumber: 61\n      }\n    }, __jsx(EditIcon, {\n      fontSize: \"small\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 166,\n        columnNumber: 65\n      }\n    }))))), __jsx(Tooltip, {\n      title: \"X\\xF3a h\\xF3a \\u0111\\u01A1n\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 171,\n        columnNumber: 49\n      }\n    }, __jsx(IconButton, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 172,\n        columnNumber: 53\n      }\n    }, __jsx(DeleteIcon, {\n      onClick: function onClick() {\n        return deleteOrder(row.id);\n      },\n      fontSize: \"small\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 173,\n        columnNumber: 57\n      }\n    })))));\n  })), \"/ \", __jsx(MyTablePagination, {\n    labelUnit: \"h\\xF3a \\u0111\\u01A1n\",\n    count: data === null || data === void 0 ? void 0 : data.count,\n    rowsPerPage: limit,\n    page: page,\n    onChangePage: function onChangePage(event, page, rowsPerPage) {\n      Router.push(\"/cms/order?page=\".concat(page, \"&limit=\").concat(rowsPerPage, \"&search=\").concat(q));\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 181,\n      columnNumber: 31\n    }\n  })) : __jsx(TableBody, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 192,\n      columnNumber: 33\n    }\n  }, __jsx(TableRow, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 193,\n      columnNumber: 37\n    }\n  }, __jsx(TableCell, {\n    colSpan: 3,\n    align: \"left\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 194,\n      columnNumber: 41\n    }\n  }, data.message)))))));\n}\n\n_s(render, \"rlg3TFilSYDWzHaTnkiNAwbTuj4=\", false, function () {\n  return [useForm, useRouter];\n});\n\nvar _c;\n\n$RefreshReg$(_c, \"OrderPage\");","map":{"version":3,"sources":["/home/hao/Deadline/mhhpm_18_3_final/FE-KTXSHOP-SELLER/pages/cms/order/index.js"],"names":["React","useEffect","useState","Head","Link","Router","useRouter","MyTablePagination","useForm","Button","Paper","Table","TableBody","TableCell","TableContainer","TableHead","TableRow","Tooltip","faPlus","FontAwesomeIcon","IconButton","InputBase","EditIcon","DeleteIcon","SearchIcon","MyCard","MyCardActions","MyCardHeader","renderWithLoggedInUser","styles","formatTime","loadOrderData","ctx","data","props","fetch","process","env","API_HOST","then","response","json","res","count","meta","pagination","total","map","item","push","attributes","id","OrderPage","render","register","handleSubmit","errors","router","setData","search","setSearch","query","q","page","parseInt","limit","handleChange","event","value","target","onSearch","formData","formatUrlSearch","error","console","log","deleteOrder","method","orderList","filter","v","marginRight","input","key","iconButton","tableLayout","length","row","overflowWrap","ProductID","Quantity","PurchaseDate","Subtotal","Status","rowsPerPage","message"],"mappings":"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","sourcesContent":["\nimport React, { useEffect, useState } from \"react\";\nimport Head from \"next/head\";\nimport Link from \"next/link\";\nimport Router, { useRouter } from \"next/router\";\nimport MyTablePagination from \"../../../component/my-pagination/my-pagination\";\nimport { useForm } from \"react-hook-form\";\nimport {\n    Button, Paper, Table, TableBody,\n    TableCell, TableContainer, TableHead, TableRow, Tooltip\n} from \"@material-ui/core\";\nimport { faPlus } from \"@fortawesome/free-solid-svg-icons\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport IconButton from '@material-ui/core/IconButton';\nimport InputBase from '@material-ui/core/InputBase';\nimport EditIcon from '@material-ui/icons/Edit';\nimport DeleteIcon from '@material-ui/icons/Delete';\nimport SearchIcon from '@material-ui/icons/Search';\nimport { MyCard, MyCardActions, MyCardHeader } from \"../../../component/my-card/my-card\";\nimport { doWithLoggedInUser, renderWithLoggedInUser } from \"../../../lib/login\";\nimport styles from \"./order.module.css\";\nimport { formatTime } from \"../../../utils/func\";\n\nexport async function getServerSideProps(ctx) {\n    return await doWithLoggedInUser(ctx, (ctx) => {\n        return loadOrderData(ctx)\n    })\n}\n\nexport async function loadOrderData(ctx) {\n    // setup data\n    let data = { props: { data: [] } }\n    await fetch(process.env.API_HOST + '/api/orders')\n        .then(response => response.json())\n        .then(res => {\n            data.props.count = res.meta.pagination.total\n            res.data.map(item => {\n                data.props.data.push({ ...item.attributes, id: item.id })\n            })\n        });\n    return data\n}\n\nexport default function OrderPage(props) {\n    return renderWithLoggedInUser(props, render)\n}\n\nfunction render(props) {\n    const { register, handleSubmit, errors } = useForm();\n    let router = useRouter();\n    let [data, setData] = useState(props);\n    let [search, setSearch] = useState('');\n    useEffect(() => {\n        setData(props);\n        setSearch(typeof router.query.search === 'undefined' ? '' : q)\n    }, [props]);\n\n    let page = parseInt(router.query.page) || 0\n    let limit = parseInt(router.query.limit) || 20\n    let q = router.query.search || ''\n\n    async function handleChange(event) {\n        const value = event.target.value;\n        setSearch(value)\n    }\n\n    function onSearch(formData) {\n        try {\n            q = formatUrlSearch(search);\n            Router.push(`/cms/order?search=${q}`);\n        } catch (error) {\n            console.log(error)\n        }\n    }\n\n    async function deleteOrder(id) {\n        await fetch(process.env.API_HOST + \"/api/orders/\" + id, {\n            method: 'DELETE',\n        }).then(response => response.json())\n            .then(res => console.log(res));\n        let orderList = [...data.data]\n        setData({ data: orderList.filter((v) => v.id != id), count: data.count - 1 })\n    }\n\n    return (\n        <div >\n            <Head>\n                <title>Danh sách hóa đơn</title>\n            </Head>\n            <MyCard>\n                <MyCardHeader title=\"Danh sách hóa đơn\">\n                    <Link href=\"/cms/order/new\">\n                        <Button variant=\"contained\" color=\"primary\">\n                            <FontAwesomeIcon icon={faPlus} style={{ marginRight: 8 }} />  Thêm hóa đơn\n                            </Button>\n                    </Link>\n                </MyCardHeader>\n                <MyCardActions>\n                    <Paper className={styles.search}>\n                        <InputBase\n                            id=\"q\"\n                            name=\"q\"\n                            className={styles.input}\n                            value={search}\n                            autoComplete='off'\n                            onChange={handleChange}\n                            inputRef={register}\n                            onKeyPress={event => {\n                                if (event.key === 'Enter') {\n                                    onSearch()\n                                }\n                            }}\n                            placeholder=\"Nhập tên hóa đơn\"\n                            inputProps={{ 'aria-label': 'Nhập tên hóa đơn' }}\n                        />\n                        <IconButton className={styles.iconButton} aria-label=\"search\"\n                            onClick={onSearch}>\n                            <SearchIcon />\n                        </IconButton>\n                    </Paper>\n                </MyCardActions>\n                <TableContainer component={Paper}>\n                    <Table size=\"small\" aria-label=\"a dense table\" style={{ tableLayout: 'fixed' }}>\n                        <colgroup>\n                            <col width=\"15%\" />\n                            <col width=\"15%\" />\n                            <col width=\"15%\" />\n                            <col width=\"15%\" />\n                            <col width=\"15%\" />\n                            <col width=\"15%\" />\n                            <col width=\"10%\" />\n                        </colgroup>\n                        <TableHead>\n                            <TableRow>\n                                <TableCell align=\"left\">ID</TableCell>\n                                <TableCell align=\"left\">ProductID</TableCell>\n                                <TableCell align=\"left\">Số lượng</TableCell>\n                                <TableCell align=\"left\">Thời gian tạo</TableCell>\n                                <TableCell align=\"left\"> Tổng tiền </TableCell>\n                                <TableCell align=\"left\"> Trạng thái </TableCell>\n                                <TableCell align=\"center\">Thao tác</TableCell>\n                            </TableRow>\n                        </TableHead>\n                        {data.data?.length > 0 ? (\n                            <>\n                                <TableBody>\n                                    {data.data?.map((row) => (\n                                        <TableRow key={row.id}>\n                                            <TableCell align=\"left\">\n                                                {row.id}\n                                            </TableCell>\n                                            <TableCell align=\"left\" className={styles.overflowWrap}>\n                                                {row.ProductID}\n                                            </TableCell>\n                                            <TableCell align=\"left\" className={styles.overflowWrap}>\n                                                {row.Quantity}\n                                            </TableCell>\n                                            <TableCell align=\"left\">{row.PurchaseDate}</TableCell>\n                                            <TableCell align=\"left\">{row.Subtotal}vnđ</TableCell>\n                                            <TableCell align=\"left\">{row.Status}</TableCell>\n                                            <TableCell align=\"center\">\n                                                <Link href={`/cms/order/edit?orderId=${row.id}`}>\n                                                    <a>\n                                                        <Tooltip title=\"Cập nhật thông tin\">\n                                                            <IconButton>\n                                                                <EditIcon fontSize=\"small\" />\n                                                            </IconButton>\n                                                        </Tooltip>\n                                                    </a>\n                                                </Link>\n                                                <Tooltip title=\"Xóa hóa đơn\">\n                                                    <IconButton>\n                                                        <DeleteIcon onClick={() => deleteOrder(row.id)} fontSize=\"small\" />\n                                                    </IconButton>\n                                                </Tooltip>\n\n                                            </TableCell>\n                                        </TableRow>\n                                    ))}\n                                </TableBody>\n                            / <MyTablePagination\n                                    labelUnit=\"hóa đơn\"\n                                    count={data?.count}\n                                    rowsPerPage={limit}\n                                    page={page}\n                                    onChangePage={(event, page, rowsPerPage) => {\n                                        Router.push(`/cms/order?page=${page}&limit=${rowsPerPage}&search=${q}`)\n                                    }}\n                                />\n                            </>\n                        ) : (\n                                <TableBody>\n                                    <TableRow>\n                                        <TableCell colSpan={3} align=\"left\">{data.message}</TableCell>\n                                    </TableRow>\n                                </TableBody>\n                            )}\n\n                    </Table>\n                </TableContainer>\n            </MyCard>\n        </div >\n    )\n}"]},"metadata":{},"sourceType":"module"}