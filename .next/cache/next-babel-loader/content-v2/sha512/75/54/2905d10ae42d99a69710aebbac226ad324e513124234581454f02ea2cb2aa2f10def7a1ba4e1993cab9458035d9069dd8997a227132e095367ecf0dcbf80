{"ast":null,"code":"import _defineProperty from \"/home/hao/Deadline/mhhpm_18_3_final/FE-KTXSHOP-SELLER/node_modules/next/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _regeneratorRuntime from \"/home/hao/Deadline/mhhpm_18_3_final/FE-KTXSHOP-SELLER/node_modules/next/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/home/hao/Deadline/mhhpm_18_3_final/FE-KTXSHOP-SELLER/node_modules/next/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\n\nvar _jsxFileName = \"/home/hao/Deadline/mhhpm_18_3_final/FE-KTXSHOP-SELLER/pages/cms/product/edit.js\",\n    _s = $RefreshSig$();\n\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport Head from \"next/head\";\nimport React, { useState } from \"react\";\nimport { useForm } from \"react-hook-form\";\nimport Image from 'next/image';\nimport { Box, Button, CircularProgress, FormGroup, Grid, Link, Paper, TextField } from \"@material-ui/core\";\nimport { renderWithLoggedInUser } from \"../../../lib/login\";\nimport { MyCard, MyCardContent, MyCardHeader } from \"../../../component/my-card/my-card\";\nimport styles from \"./product.module.css\";\nexport var __N_SSP = true;\nexport function loadIngredientData(_x) {\n  return _loadIngredientData.apply(this, arguments);\n}\n\nfunction _loadIngredientData() {\n  _loadIngredientData = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3(ctx) {\n    var data, id;\n    return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n      while (1) {\n        switch (_context3.prev = _context3.next) {\n          case 0:\n            data = {\n              props: {\n                data: []\n              }\n            };\n            id = ctx.query.productId;\n            _context3.next = 4;\n            return fetch(process.env.API_HOST + '/api/products/' + id).then(function (response) {\n              return response.json();\n            }).then(function (res) {\n              data.props.data.push(_objectSpread(_objectSpread({}, res.data.attributes), {}, {\n                id: res.data.id\n              }));\n            });\n\n          case 4:\n            return _context3.abrupt(\"return\", data);\n\n          case 5:\n          case \"end\":\n            return _context3.stop();\n        }\n      }\n    }, _callee3);\n  }));\n  return _loadIngredientData.apply(this, arguments);\n}\n\nexport default function EditPage(props) {\n  return renderWithLoggedInUser(props, render);\n}\n_c = EditPage;\n\nfunction render(props) {\n  _s();\n\n  var _errors$name;\n\n  // let _client = getIngredientClient();\n  var _useState = useState(false),\n      loading = _useState[0],\n      setLoading = _useState[1];\n\n  var data = props.data[0];\n\n  if (props.status && props.status !== \"OK\") {\n    return __jsx(AppCMS, {\n      select: \"/cms/ingredient\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 48,\n        columnNumber: 7\n      }\n    }, __jsx(Head, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 49,\n        columnNumber: 9\n      }\n    }, __jsx(\"title\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 50,\n        columnNumber: 11\n      }\n    }, \"Chi ti\\u1EBFt s\\u1EA3n ph\\u1EA9m\")), __jsx(MyCard, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 52,\n        columnNumber: 9\n      }\n    }, __jsx(MyCardHeader, {\n      title: \"Chi ti\\u1EBFt s\\u1EA3n ph\\u1EA9m\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 53,\n        columnNumber: 11\n      }\n    }), __jsx(Box, {\n      component: Paper,\n      display: \"block\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 54,\n        columnNumber: 11\n      }\n    }, __jsx(FormGroup, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 55,\n        columnNumber: 13\n      }\n    }, __jsx(\"form\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 56,\n        columnNumber: 15\n      }\n    }, __jsx(Grid, {\n      container: true,\n      spacing: 3,\n      direction: \"row\",\n      justify: \"space-between\",\n      alignItems: \"flex-start\",\n      className: styles.contentPadding,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 57,\n        columnNumber: 17\n      }\n    }, __jsx(Grid, {\n      item: true,\n      xs: 12,\n      md: 12,\n      sm: 12,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 65,\n        columnNumber: 19\n      }\n    }, __jsx(\"span\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 66,\n        columnNumber: 21\n      }\n    }, props.message)))))), __jsx(Box, {\n      component: Paper,\n      display: \"block\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 72,\n        columnNumber: 11\n      }\n    })));\n  }\n\n  var _useForm = useForm({\n    defaultValues: data,\n    mode: \"onChange\"\n  }),\n      register = _useForm.register,\n      handleSubmit = _useForm.handleSubmit,\n      errors = _useForm.errors,\n      setValue = _useForm.setValue,\n      reset = _useForm.reset;\n\n  function updateIngredient(_x2) {\n    return _updateIngredient.apply(this, arguments);\n  } // func onSubmit used because useForm not working with some fields\n\n\n  function _updateIngredient() {\n    _updateIngredient = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(formData) {\n      var data;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              data = {\n                props: {}\n              };\n              setLoading(true);\n              _context.next = 4;\n              return _client.updateIngredient(formData);\n\n            case 4:\n              data.props = _context.sent;\n              setLoading(false);\n\n              if (data.props.status === \"OK\") {\n                success(\"Cập nhật thông tin sản phẩm thành công\");\n                reset({});\n              } else {\n                error(data.props.message || \"Thao tác không thành công, vui lòng thử lại sau\");\n              }\n\n            case 7:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n    return _updateIngredient.apply(this, arguments);\n  }\n\n  function onSubmit(_x3) {\n    return _onSubmit.apply(this, arguments);\n  }\n\n  function _onSubmit() {\n    _onSubmit = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(formData) {\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.prev = 0;\n              formData.name = formData === null || formData === void 0 ? void 0 : formData.name.trim().replace(/\\s+/g, \" \");\n              formData.code = data.code;\n              _context2.next = 5;\n              return updateIngredient(formData);\n\n            case 5:\n              _context2.next = 11;\n              break;\n\n            case 7:\n              _context2.prev = 7;\n              _context2.t0 = _context2[\"catch\"](0);\n              setLoading(false);\n              error(_context2.t0.message || _context2.t0.toString());\n\n            case 11:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2, null, [[0, 7]]);\n    }));\n    return _onSubmit.apply(this, arguments);\n  }\n\n  return __jsx(\"div\", {\n    select: \"/cms/ingredient\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 111,\n      columnNumber: 5\n    }\n  }, __jsx(Head, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 112,\n      columnNumber: 7\n    }\n  }, __jsx(\"title\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 9\n    }\n  }, \"C\\u1EADp nh\\u1EADt s\\u1EA3n ph\\u1EA9m\")), __jsx(MyCard, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 115,\n      columnNumber: 7\n    }\n  }, __jsx(MyCardHeader, {\n    title: \"sản phẩm #\" + data.id,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 116,\n      columnNumber: 9\n    }\n  }), __jsx(FormGroup, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 117,\n      columnNumber: 9\n    }\n  }, __jsx(MyCardContent, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 118,\n      columnNumber: 11\n    }\n  }, __jsx(\"form\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 119,\n      columnNumber: 13\n    }\n  }, __jsx(Grid, {\n    container: true,\n    item: true,\n    xs: 12,\n    md: 6,\n    sm: 12,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 120,\n      columnNumber: 15\n    }\n  }, __jsx(Grid, {\n    style: {\n      margin: \"20px\"\n    },\n    item: true,\n    xs: 12,\n    md: 12,\n    sm: 6,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 121,\n      columnNumber: 17\n    }\n  }, __jsx(Image, {\n    src: data.imageUrl,\n    height: 120,\n    width: 120,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 122,\n      columnNumber: 19\n    }\n  })), __jsx(Grid, {\n    item: true,\n    xs: 12,\n    md: 12,\n    sm: 12,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 124,\n      columnNumber: 17\n    }\n  }, __jsx(TextField, {\n    id: \"ProductName\",\n    name: \"ProductName\",\n    label: \"T\\xEAn s\\u1EA3n ph\\u1EA9m\",\n    placeholder: \"\",\n    helperText: (_errors$name = errors.name) === null || _errors$name === void 0 ? void 0 : _errors$name.message,\n    margin: \"normal\",\n    variant: \"outlined\",\n    size: \"small\",\n    InputLabelProps: {\n      shrink: true\n    },\n    style: {\n      margin: 12,\n      width: \"calc(100% - 24px)\"\n    },\n    error: errors.name ? true : false,\n    required: true,\n    inputRef: register({\n      required: \"Vui lòng nhập tên sản phẩm\",\n      maxLength: {\n        value: 250,\n        message: \"Tên sản phẩm có độ dài tối đa 250 kí tự\"\n      },\n      minLength: {\n        value: 1,\n        message: \"Tên sản phẩm có độ dài tối thiểu 1 kí tự\"\n      },\n      pattern: {\n        value: /^(?!.*[ ]{2})/,\n        message: \"Tên không hợp lệ (không được dư khoảng trắng).\"\n      }\n    }),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 125,\n      columnNumber: 19\n    }\n  })), __jsx(Grid, {\n    item: true,\n    xs: 12,\n    md: 12,\n    sm: 6,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 157,\n      columnNumber: 17\n    }\n  }, __jsx(TextField, {\n    id: \"Price\",\n    name: \"Price\",\n    label: \"Gi\\xE1\",\n    placeholder: \"\",\n    variant: \"outlined\",\n    size: \"small\",\n    margin: \"normal\",\n    multiline: true,\n    InputLabelProps: {\n      shrink: true\n    },\n    style: {\n      margin: 12,\n      width: \"calc(100% - 24px)\"\n    },\n    inputRef: register,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 158,\n      columnNumber: 19\n    }\n  })), __jsx(Grid, {\n    item: true,\n    xs: 12,\n    md: 12,\n    sm: 6,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 174,\n      columnNumber: 17\n    }\n  })), __jsx(Grid, {\n    item: true,\n    xs: 12,\n    md: 12,\n    sm: 12,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 176,\n      columnNumber: 15\n    }\n  }, __jsx(Link, {\n    href: \"/cms/product\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 177,\n      columnNumber: 17\n    }\n  }, __jsx(Button, {\n    variant: \"contained\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 178,\n      columnNumber: 19\n    }\n  }, \"Tr\\u1EDF l\\u1EA1i\"))))))));\n}\n\n_s(render, \"9z5SEQygS6hqZY1T4TCWo7OlE5c=\", false, function () {\n  return [useForm];\n});\n\nvar _c;\n\n$RefreshReg$(_c, \"EditPage\");","map":{"version":3,"sources":["/home/hao/Deadline/mhhpm_18_3_final/FE-KTXSHOP-SELLER/pages/cms/product/edit.js"],"names":["Head","React","useState","useForm","Image","Box","Button","CircularProgress","FormGroup","Grid","Link","Paper","TextField","renderWithLoggedInUser","MyCard","MyCardContent","MyCardHeader","styles","loadIngredientData","ctx","data","props","id","query","productId","fetch","process","env","API_HOST","then","response","json","res","push","attributes","EditPage","render","loading","setLoading","status","contentPadding","message","defaultValues","mode","register","handleSubmit","errors","setValue","reset","updateIngredient","formData","_client","success","error","onSubmit","name","trim","replace","code","toString","margin","imageUrl","shrink","width","required","maxLength","value","minLength","pattern"],"mappings":"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","sourcesContent":["import Head from \"next/head\";\nimport React, { useState } from \"react\";\nimport { useForm } from \"react-hook-form\";\nimport Image from 'next/image'\nimport {\n  Box, Button, CircularProgress,\n  FormGroup, Grid, Link, Paper, TextField\n} from \"@material-ui/core\";\nimport {\n  doWithLoggedInUser,\n  renderWithLoggedInUser\n} from \"../../../lib/login\";\nimport { MyCard, MyCardContent, MyCardHeader } from \"../../../component/my-card/my-card\";\nimport styles from \"./product.module.css\";\n\nexport async function getServerSideProps(ctx) {\n  return await doWithLoggedInUser(ctx, (ctx) => {\n    return loadIngredientData(ctx);\n  });\n}\n\nexport async function loadIngredientData(ctx) {\n  let data = {\n    props: {\n      data: [],\n    }\n  };\n  let id = ctx.query.productId;\n  await fetch(process.env.API_HOST + '/api/products/' + id)\n    .then(response => response.json())\n    .then(res => {\n      data.props.data.push({ ...res.data.attributes, id: res.data.id })\n    });\n  return data;\n}\n\nexport default function EditPage(props) {\n  return renderWithLoggedInUser(props, render);\n}\n\n\nfunction render(props) {\n  // let _client = getIngredientClient();\n  const [loading, setLoading] = useState(false);\n  const data = props.data[0]\n  if (props.status && props.status !== \"OK\") {\n    return (\n      <AppCMS select=\"/cms/ingredient\">\n        <Head>\n          <title>Chi tiết sản phẩm</title>\n        </Head>\n        <MyCard>\n          <MyCardHeader title=\"Chi tiết sản phẩm\" />\n          <Box component={Paper} display=\"block\">\n            <FormGroup>\n              <form>\n                <Grid\n                  container\n                  spacing={3}\n                  direction=\"row\"\n                  justify=\"space-between\"\n                  alignItems=\"flex-start\"\n                  className={styles.contentPadding}\n                >\n                  <Grid item xs={12} md={12} sm={12}>\n                    <span>{props.message}</span>\n                  </Grid>\n                </Grid>\n              </form>\n            </FormGroup>\n          </Box>\n          <Box component={Paper} display=\"block\"></Box>\n        </MyCard>\n      </AppCMS>\n    );\n  }\n\n  const { register, handleSubmit, errors, setValue, reset } = useForm({\n    defaultValues: data,\n    mode: \"onChange\",\n  });\n\n  async function updateIngredient(formData) {\n    let data = { props: {} };\n    setLoading(true);\n    data.props = await _client.updateIngredient(formData);\n    setLoading(false);\n    if (data.props.status === \"OK\") {\n      success(\"Cập nhật thông tin sản phẩm thành công\");\n      reset({})\n    } else {\n      error(\n        data.props.message || \"Thao tác không thành công, vui lòng thử lại sau\"\n      );\n    }\n  }\n\n  // func onSubmit used because useForm not working with some fields\n  async function onSubmit(formData) {\n    try {\n      formData.name = formData?.name.trim().replace(/\\s+/g, \" \");\n      formData.code = data.code\n      await updateIngredient(formData);\n    } catch (err) {\n      setLoading(false);\n      error(err.message || err.toString());\n    }\n  }\n\n  return (\n    <div select=\"/cms/ingredient\">\n      <Head>\n        <title>Cập nhật sản phẩm</title>\n      </Head>\n      <MyCard>\n        <MyCardHeader title={\"sản phẩm #\" + data.id} />\n        <FormGroup>\n          <MyCardContent>\n            <form>\n              <Grid container item xs={12} md={6} sm={12}>\n                <Grid style={{ margin: \"20px\" }} item xs={12} md={12} sm={6}>\n                  <Image src={data.imageUrl} height={120} width={120} />\n                </Grid>\n                <Grid item xs={12} md={12} sm={12}>\n                  <TextField\n                    id=\"ProductName\"\n                    name=\"ProductName\"\n                    label=\"Tên sản phẩm\"\n                    placeholder=\"\"\n                    helperText={errors.name?.message}\n                    margin=\"normal\"\n                    variant=\"outlined\"\n                    size=\"small\"\n                    InputLabelProps={{\n                      shrink: true,\n                    }}\n                    style={{ margin: 12, width: \"calc(100% - 24px)\" }}\n                    error={errors.name ? true : false}\n                    required\n                    inputRef={register({\n                      required: \"Vui lòng nhập tên sản phẩm\",\n                      maxLength: {\n                        value: 250,\n                        message: \"Tên sản phẩm có độ dài tối đa 250 kí tự\",\n                      },\n                      minLength: {\n                        value: 1,\n                        message: \"Tên sản phẩm có độ dài tối thiểu 1 kí tự\",\n                      },\n                      pattern: {\n                        value: /^(?!.*[ ]{2})/,\n                        message: \"Tên không hợp lệ (không được dư khoảng trắng).\"\n                      },\n                    })}\n                  />\n                </Grid>\n                <Grid item xs={12} md={12} sm={6}>\n                  <TextField\n                    id=\"Price\"\n                    name=\"Price\"\n                    label=\"Giá\"\n                    placeholder=\"\"\n                    variant=\"outlined\"\n                    size=\"small\"\n                    margin=\"normal\"\n                    multiline\n                    InputLabelProps={{\n                      shrink: true,\n                    }}\n                    style={{ margin: 12, width: \"calc(100% - 24px)\" }}\n                    inputRef={register}\n                  />\n                </Grid>\n                <Grid item xs={12} md={12} sm={6} />\n              </Grid>\n              <Grid item xs={12} md={12} sm={12}>\n                <Link href=\"/cms/product\">\n                  <Button\n                    variant=\"contained\"\n                  >\n                    Trở lại\n                                    </Button>\n                </Link>\n              </Grid>\n            </form>\n          </MyCardContent>\n        </FormGroup>\n      </MyCard>\n    </div>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}