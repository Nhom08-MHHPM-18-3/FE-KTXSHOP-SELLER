{"ast":null,"code":"import _defineProperty from \"D:/Learning/Learning/HKI_NamTu/MoHinhHoaPhanMem/KTXSHOP/Source/FE-KTXSHOP-SELLER/node_modules/next/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _toConsumableArray from \"D:/Learning/Learning/HKI_NamTu/MoHinhHoaPhanMem/KTXSHOP/Source/FE-KTXSHOP-SELLER/node_modules/next/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _regeneratorRuntime from \"D:/Learning/Learning/HKI_NamTu/MoHinhHoaPhanMem/KTXSHOP/Source/FE-KTXSHOP-SELLER/node_modules/next/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"D:/Learning/Learning/HKI_NamTu/MoHinhHoaPhanMem/KTXSHOP/Source/FE-KTXSHOP-SELLER/node_modules/next/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\n\nvar _jsxFileName = \"D:\\\\Learning\\\\Learning\\\\HKI_NamTu\\\\MoHinhHoaPhanMem\\\\KTXSHOP\\\\Source\\\\FE-KTXSHOP-SELLER\\\\pages\\\\cms\\\\product\\\\index.js\",\n    _s = $RefreshSig$();\n\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport { Button, Paper, Table, TableBody, TableCell, TableContainer, TableHead, TableRow, Tooltip } from \"@material-ui/core\";\nimport Grid from \"@material-ui/core/Grid\";\nimport IconButton from \"@material-ui/core/IconButton\";\nimport InputBase from \"@material-ui/core/InputBase\";\nimport EditIcon from \"@material-ui/icons/Edit\";\nimport DeleteIcon from \"@material-ui/icons/Delete\";\nimport SearchIcon from \"@material-ui/icons/Search\";\nimport { faPlus } from \"@fortawesome/free-solid-svg-icons\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { renderWithLoggedInUser } from \"../../../lib/login\";\nimport MyTablePagination from \"../../../component/my-pagination/my-pagination\"; // import { getProductClient } from \"client/product\";\n\nimport { formatEllipsisText, formatUrlSearch } from \"../../../utils/func\";\nimport Head from \"next/head\";\nimport Image from \"next/image\";\nimport Link from \"next/link\";\nimport Router, { useRouter } from \"next/router\";\nimport React, { useEffect, useState } from \"react\";\nimport styles from \"./product.module.css\";\nimport { MyCard, MyCardActions, MyCardHeader } from \"../../../component/my-card/my-card\";\nvar LIMIT = 20;\nexport var __N_SSP = true;\nexport function loadProductData(_x) {\n  return _loadProductData.apply(this, arguments);\n}\n\nfunction _loadProductData() {\n  _loadProductData = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4(ctx) {\n    var data;\n    return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n      while (1) {\n        switch (_context4.prev = _context4.next) {\n          case 0:\n            data = {\n              props: {\n                data: []\n              }\n            };\n            _context4.next = 3;\n            return fetch(process.env.API_HOST + '/api/products').then(function (response) {\n              return response.json();\n            }).then(function (res) {\n              data.props.count = res.meta.pagination.total;\n              res.data.map(function (item) {\n                data.props.data.push(_objectSpread(_objectSpread({}, item.attributes), {}, {\n                  id: item.id\n                }));\n              });\n            });\n\n          case 3:\n            return _context4.abrupt(\"return\", data);\n\n          case 4:\n          case \"end\":\n            return _context4.stop();\n        }\n      }\n    }, _callee4);\n  }));\n  return _loadProductData.apply(this, arguments);\n}\n\nexport function getFirstImage(val) {\n  if (val && val.length > 0) {\n    return val[0];\n  }\n\n  return \"/default.png\";\n}\nexport default function ProductPage(props) {\n  return renderWithLoggedInUser(props, render);\n}\n_c = ProductPage;\n\nfunction render(props) {\n  _s();\n\n  var _this = this;\n\n  var router = useRouter();\n\n  var _useState = useState(\"\"),\n      search = _useState[0],\n      setSearch = _useState[1];\n\n  var _useState2 = useState(props),\n      data = _useState2[0],\n      setData = _useState2[1];\n\n  var _useState3 = useState(parseInt(router.query.page) || 0),\n      page = _useState3[0],\n      setPage = _useState3[1];\n\n  var _useState4 = useState(parseInt(router.query.limit) || LIMIT),\n      limit = _useState4[0],\n      setLimit = _useState4[1];\n\n  var q = router.query.search || \"\";\n  useEffect(function () {\n    setData(props);\n    setSearch(router.query.search || \"\");\n    setPage(parseInt(router.query.page) || 0);\n    setLimit(parseInt(router.query.limit) || LIMIT);\n  }, [props.data]);\n\n  function handleChange(_x2) {\n    return _handleChange.apply(this, arguments);\n  }\n\n  function _handleChange() {\n    _handleChange = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(event) {\n      var target, value;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              target = event.target;\n              value = target.value;\n              setSearch(value);\n\n            case 3:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n    return _handleChange.apply(this, arguments);\n  }\n\n  function onSearch() {\n    return _onSearch.apply(this, arguments);\n  }\n\n  function _onSearch() {\n    _onSearch = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              q = formatUrlSearch(search);\n              router.push(\"?search=\".concat(q));\n\n            case 2:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n    return _onSearch.apply(this, arguments);\n  }\n\n  function deleteProduct(_x3) {\n    return _deleteProduct.apply(this, arguments);\n  }\n\n  function _deleteProduct() {\n    _deleteProduct = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3(id) {\n      var productList;\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              _context3.next = 2;\n              return fetch(process.env.API_HOST + \"/api/products/\" + id, {\n                method: 'DELETE'\n              }).then(function (response) {\n                return response.json();\n              }).then(function (res) {\n                return console.log(res);\n              });\n\n            case 2:\n              productList = _toConsumableArray(data.data);\n              setData({\n                data: productList.filter(function (v) {\n                  return v.id != id;\n                }),\n                count: data.count - 1\n              });\n\n            case 4:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3);\n    }));\n    return _deleteProduct.apply(this, arguments);\n  }\n\n  return __jsx(\"div\", {\n    select: \"/cms/product\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 9\n    }\n  }, __jsx(Head, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 13\n    }\n  }, __jsx(\"title\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 17\n    }\n  }, \"Danh s\\xE1ch s\\u1EA3n ph\\u1EA9m\")), __jsx(MyCard, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 96,\n      columnNumber: 13\n    }\n  }, __jsx(MyCardHeader, {\n    title: \"Danh s\\xE1ch s\\u1EA3n ph\\u1EA9m\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 17\n    }\n  }, __jsx(Link, {\n    href: \"/cms/product/new\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 21\n    }\n  }, __jsx(Button, {\n    variant: \"contained\",\n    color: \"primary\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 25\n    }\n  }, __jsx(FontAwesomeIcon, {\n    icon: faPlus,\n    style: {\n      marginRight: 8\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 100,\n      columnNumber: 29\n    }\n  }), \"Th\\xEAm s\\u1EA3n ph\\u1EA9m\"))), __jsx(MyCardActions, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 17\n    }\n  }, __jsx(Grid, {\n    container: true,\n    spacing: 3,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 21\n    }\n  }, __jsx(Grid, {\n    item: true,\n    xs: 12,\n    md: 4,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 25\n    }\n  }, __jsx(Paper, {\n    className: styles.search,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 29\n    }\n  }, __jsx(InputBase, {\n    id: \"q\",\n    name: \"q\",\n    className: styles.input,\n    value: search,\n    onChange: handleChange,\n    onKeyPress: function onKeyPress(event) {\n      if (event.key === \"Enter\") {\n        onSearch();\n      }\n    },\n    autoComplete: \"off\",\n    placeholder: \"Nh\\u1EADp t\\xEAn ho\\u1EB7c m\\xE3 s\\u1EA3n ph\\u1EA9m\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 108,\n      columnNumber: 33\n    }\n  }), __jsx(IconButton, {\n    className: styles.iconButton,\n    \"aria-label\": \"search\",\n    onClick: onSearch,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 122,\n      columnNumber: 33\n    }\n  }, __jsx(SearchIcon, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 123,\n      columnNumber: 37\n    }\n  })))), __jsx(Grid, {\n    item: true,\n    xs: 6,\n    sm: 3,\n    md: 3,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 127,\n      columnNumber: 25\n    }\n  })))), __jsx(TableContainer, {\n    component: Paper,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 131,\n      columnNumber: 13\n    }\n  }, __jsx(Table, {\n    size: \"small\",\n    \"aria-label\": \"a dense table\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 132,\n      columnNumber: 17\n    }\n  }, __jsx(TableHead, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 134,\n      columnNumber: 21\n    }\n  }, __jsx(TableRow, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 135,\n      columnNumber: 25\n    }\n  }, __jsx(TableCell, {\n    align: \"left\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 136,\n      columnNumber: 29\n    }\n  }, \"ID\"), __jsx(TableCell, {\n    align: \"left\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 137,\n      columnNumber: 29\n    }\n  }, \"H\\xECnh \\u1EA3nh\"), __jsx(TableCell, {\n    align: \"left\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 138,\n      columnNumber: 29\n    }\n  }, \"T\\xEAn s\\u1EA3n ph\\u1EA9m\"), __jsx(TableCell, {\n    align: \"left\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 139,\n      columnNumber: 29\n    }\n  }, \"Gi\\xE1\"), __jsx(TableCell, {\n    align: \"center\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 140,\n      columnNumber: 29\n    }\n  }, \"Thao t\\xE1c\"))), data.count <= 0 ? __jsx(TableRow, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 144,\n      columnNumber: 25\n    }\n  }, __jsx(TableCell, {\n    colSpan: 5,\n    align: \"left\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 145,\n      columnNumber: 29\n    }\n  })) : __jsx(TableBody, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 149,\n      columnNumber: 29\n    }\n  }, data.data.map(function (row, i) {\n    return __jsx(TableRow, {\n      key: i,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 151,\n        columnNumber: 37\n      }\n    }, __jsx(TableCell, {\n      component: \"th\",\n      scope: \"row\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 152,\n        columnNumber: 41\n      }\n    }, row.id), __jsx(TableCell, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 155,\n        columnNumber: 41\n      }\n    }, __jsx(Image, {\n      src: row.imageUrl ? row.imageUrl : \"/\",\n      title: \"image\",\n      alt: \"image\",\n      width: 60,\n      height: 60,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 156,\n        columnNumber: 45\n      }\n    })), __jsx(TableCell, {\n      align: \"left\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 158,\n        columnNumber: 41\n      }\n    }, formatEllipsisText(row.name)), __jsx(TableCell, {\n      align: \"left\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 159,\n        columnNumber: 41\n      }\n    }, row.price, \" vn\\u0111\"), __jsx(TableCell, {\n      align: \"center\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 160,\n        columnNumber: 41\n      }\n    }, __jsx(Link, {\n      href: \"/cms/product/edit?productId=\".concat(row.id),\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 161,\n        columnNumber: 45\n      }\n    }, __jsx(\"a\", {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 162,\n        columnNumber: 49\n      }\n    }, __jsx(Tooltip, {\n      title: \"C\\u1EADp nh\\u1EADt th\\xF4ng tin\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 163,\n        columnNumber: 53\n      }\n    }, __jsx(IconButton, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 164,\n        columnNumber: 57\n      }\n    }, __jsx(EditIcon, {\n      fontSize: \"small\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 165,\n        columnNumber: 61\n      }\n    }))))), __jsx(Tooltip, {\n      title: \"X\\xF3a s\\u1EA3n ph\\u1EA9m\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 170,\n        columnNumber: 45\n      }\n    }, __jsx(IconButton, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 171,\n        columnNumber: 49\n      }\n    }, __jsx(DeleteIcon, {\n      onClick: function onClick() {\n        return deleteProduct(row.id);\n      },\n      fontSize: \"small\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 172,\n        columnNumber: 53\n      }\n    })))));\n  })), data.count > 0 ? __jsx(MyTablePagination, {\n    labelUnit: \"s\\u1EA3n ph\\u1EA9m\",\n    count: data.count,\n    rowsPerPage: limit,\n    page: page,\n    onChangePage: function onChangePage(event, page, rowsPerPage) {\n      Router.push(\"/cms/product?page=\".concat(page, \"&limit=\").concat(rowsPerPage, \"&search=\").concat(search));\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 181,\n      columnNumber: 25\n    }\n  }) : __jsx(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 191,\n      columnNumber: 29\n    }\n  }))));\n}\n\n_s(render, \"rghri61CMZNARBZ+H4QLgS/LHqI=\", false, function () {\n  return [useRouter];\n});\n\nvar _c;\n\n$RefreshReg$(_c, \"ProductPage\");","map":{"version":3,"sources":["D:/Learning/Learning/HKI_NamTu/MoHinhHoaPhanMem/KTXSHOP/Source/FE-KTXSHOP-SELLER/pages/cms/product/index.js"],"names":["Button","Paper","Table","TableBody","TableCell","TableContainer","TableHead","TableRow","Tooltip","Grid","IconButton","InputBase","EditIcon","DeleteIcon","SearchIcon","faPlus","FontAwesomeIcon","renderWithLoggedInUser","MyTablePagination","formatEllipsisText","formatUrlSearch","Head","Image","Link","Router","useRouter","React","useEffect","useState","styles","MyCard","MyCardActions","MyCardHeader","LIMIT","loadProductData","ctx","data","props","fetch","process","env","API_HOST","then","response","json","res","count","meta","pagination","total","map","item","push","attributes","id","getFirstImage","val","length","ProductPage","render","router","search","setSearch","setData","parseInt","query","page","setPage","limit","setLimit","q","handleChange","event","target","value","onSearch","deleteProduct","method","console","log","productList","filter","v","marginRight","input","key","iconButton","row","i","imageUrl","name","price","rowsPerPage"],"mappings":"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","sourcesContent":["import { Button, Paper, Table, TableBody, TableCell, TableContainer, TableHead, TableRow, Tooltip } from \"@material-ui/core\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport InputBase from \"@material-ui/core/InputBase\";\r\nimport EditIcon from \"@material-ui/icons/Edit\";\r\nimport DeleteIcon from \"@material-ui/icons/Delete\";\r\nimport SearchIcon from \"@material-ui/icons/Search\";\r\nimport { faPlus } from \"@fortawesome/free-solid-svg-icons\";\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\r\nimport { doWithLoggedInUser, renderWithLoggedInUser } from \"../../../lib/login\";\r\nimport MyTablePagination from \"../../../component/my-pagination/my-pagination\";\r\n// import { getProductClient } from \"client/product\";\r\nimport { formatEllipsisText, formatUrlSearch } from \"../../../utils/func\";\r\nimport Head from \"next/head\";\r\nimport Image from \"next/image\";\r\nimport Link from \"next/link\";\r\nimport Router, { useRouter } from \"next/router\";\r\nimport React, { useEffect, useState } from \"react\";\r\nimport styles from \"./product.module.css\";\r\nimport { MyCard, MyCardActions, MyCardHeader } from \"../../../component/my-card/my-card\";\r\n\r\nconst LIMIT = 20;\r\n\r\nexport async function getServerSideProps(ctx) {\r\n    let start = +new Date()\r\n    let result = await doWithLoggedInUser(ctx, (ctx) => {\r\n        return loadProductData(ctx);\r\n    });\r\n    return result\r\n}\r\n\r\nexport async function loadProductData(ctx) {\r\n    let data = { props: { data: [] } }\r\n    await fetch(process.env.API_HOST + '/api/products')\r\n        .then(response => response.json())\r\n        .then(res => {\r\n            data.props.count = res.meta.pagination.total\r\n            res.data.map(item => {\r\n                data.props.data.push({ ...item.attributes, id: item.id })\r\n            })\r\n        });\r\n    return data\r\n}\r\n\r\nexport function getFirstImage(val) {\r\n    if (val && val.length > 0) {\r\n        return val[0];\r\n    }\r\n    return `/default.png`;\r\n}\r\n\r\nexport default function ProductPage(props) {\r\n    return renderWithLoggedInUser(props, render);\r\n}\r\n\r\nfunction render(props) {\r\n    let router = useRouter();\r\n    let [search, setSearch] = useState(\"\");\r\n    let [data, setData] = useState(props);\r\n    let [page, setPage] = useState(parseInt(router.query.page) || 0);\r\n    let [limit, setLimit] = useState(parseInt(router.query.limit) || LIMIT);\r\n    let q = router.query.search || \"\";\r\n\r\n    useEffect(() => {\r\n        setData(props);\r\n        setSearch(router.query.search || \"\");\r\n        setPage(parseInt(router.query.page) || 0);\r\n        setLimit(parseInt(router.query.limit) || LIMIT);\r\n    }, [props.data]);\r\n\r\n    async function handleChange(event) {\r\n        const target = event.target;\r\n        const value = target.value;\r\n        setSearch(value);\r\n    }\r\n\r\n    async function onSearch() {\r\n        q = formatUrlSearch(search);\r\n        router.push(`?search=${q}`);\r\n    }\r\n\r\n    async function deleteProduct(id) {\r\n        await fetch(process.env.API_HOST + \"/api/products/\" + id, {\r\n            method: 'DELETE',\r\n        }).then(response => response.json())\r\n            .then(res => console.log(res));\r\n        let productList = [...data.data]\r\n        setData({ data: productList.filter((v) => v.id != id), count: data.count - 1 })\r\n    }\r\n\r\n    return (\r\n        <div select=\"/cms/product\" >\r\n            <Head>\r\n                <title>Danh sách sản phẩm</title>\r\n            </Head>\r\n            <MyCard>\r\n                <MyCardHeader title=\"Danh sách sản phẩm\">\r\n                    <Link href=\"/cms/product/new\">\r\n                        <Button variant=\"contained\" color=\"primary\">\r\n                            <FontAwesomeIcon icon={faPlus} style={{ marginRight: 8 }} />Thêm sản phẩm\r\n                        </Button>\r\n                    </Link>\r\n                </MyCardHeader>\r\n                <MyCardActions>\r\n                    <Grid container spacing={3}>\r\n                        <Grid item xs={12} md={4}>\r\n                            <Paper className={styles.search}>\r\n                                <InputBase\r\n                                    id=\"q\"\r\n                                    name=\"q\"\r\n                                    className={styles.input}\r\n                                    value={search}\r\n                                    onChange={handleChange}\r\n                                    onKeyPress={(event) => {\r\n                                        if (event.key === \"Enter\") {\r\n                                            onSearch();\r\n                                        }\r\n                                    }}\r\n                                    autoComplete=\"off\"\r\n                                    placeholder=\"Nhập tên hoặc mã sản phẩm\"\r\n                                />\r\n                                <IconButton className={styles.iconButton} aria-label=\"search\" onClick={onSearch}>\r\n                                    <SearchIcon />\r\n                                </IconButton>\r\n                            </Paper>\r\n                        </Grid>\r\n                        <Grid item xs={6} sm={3} md={3}></Grid>\r\n                    </Grid>\r\n                </MyCardActions>\r\n            </MyCard>\r\n            <TableContainer component={Paper}>\r\n                <Table size=\"small\" aria-label=\"a dense table\">\r\n\r\n                    <TableHead>\r\n                        <TableRow>\r\n                            <TableCell align=\"left\">ID</TableCell>\r\n                            <TableCell align=\"left\">Hình ảnh</TableCell>\r\n                            <TableCell align=\"left\">Tên sản phẩm</TableCell>\r\n                            <TableCell align=\"left\">Giá</TableCell>\r\n                            <TableCell align=\"center\">Thao tác</TableCell>\r\n                        </TableRow>\r\n                    </TableHead>\r\n                    {data.count <= 0 ? (\r\n                        <TableRow>\r\n                            <TableCell colSpan={5} align=\"left\">\r\n                            </TableCell>\r\n                        </TableRow>\r\n                    ) : (\r\n                            <TableBody>\r\n                                {data.data.map((row, i) => (\r\n                                    <TableRow key={i}>\r\n                                        <TableCell component=\"th\" scope=\"row\">\r\n                                            {row.id}\r\n                                        </TableCell>\r\n                                        <TableCell>\r\n                                            <Image src={row.imageUrl ? row.imageUrl : \"/\"} title=\"image\" alt=\"image\" width={60} height={60} />\r\n                                        </TableCell>\r\n                                        <TableCell align=\"left\">{formatEllipsisText(row.name)}</TableCell>\r\n                                        <TableCell align=\"left\">{row.price} vnđ</TableCell>\r\n                                        <TableCell align=\"center\">\r\n                                            <Link href={`/cms/product/edit?productId=${row.id}`}>\r\n                                                <a>\r\n                                                    <Tooltip title=\"Cập nhật thông tin\">\r\n                                                        <IconButton>\r\n                                                            <EditIcon fontSize=\"small\" />\r\n                                                        </IconButton>\r\n                                                    </Tooltip>\r\n                                                </a>\r\n                                            </Link>\r\n                                            <Tooltip title=\"Xóa sản phẩm\">\r\n                                                <IconButton>\r\n                                                    <DeleteIcon onClick={() => deleteProduct(row.id)} fontSize=\"small\" />\r\n                                                </IconButton>\r\n                                            </Tooltip>\r\n                                        </TableCell>\r\n                                    </TableRow>\r\n                                ))}\r\n                            </TableBody>\r\n                        )}\r\n                    {data.count > 0 ? (\r\n                        <MyTablePagination\r\n                            labelUnit=\"sản phẩm\"\r\n                            count={data.count}\r\n                            rowsPerPage={limit}\r\n                            page={page}\r\n                            onChangePage={(event, page, rowsPerPage) => {\r\n                                Router.push(`/cms/product?page=${page}&limit=${rowsPerPage}&search=${search}`);\r\n                            }}\r\n                        />\r\n                    ) : (\r\n                            <div />\r\n                        )}\r\n                </Table>\r\n            </TableContainer>\r\n        </div >\r\n    );\r\n}\r\n"]},"metadata":{},"sourceType":"module"}