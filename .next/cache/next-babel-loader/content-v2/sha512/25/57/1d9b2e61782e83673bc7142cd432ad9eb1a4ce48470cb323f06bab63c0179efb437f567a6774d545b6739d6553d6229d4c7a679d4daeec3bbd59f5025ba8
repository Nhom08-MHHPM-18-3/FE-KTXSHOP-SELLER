{"ast":null,"code":"var _jsxFileName = \"/home/hao/Deadline/mhhpm_18_3_final/FE-KTXSHOP-SELLER/pages/cms/order/index.js\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport React, { useEffect, useState } from \"react\";\nimport Head from \"next/head\";\nimport Link from \"next/link\";\nimport Router, { useRouter } from \"next/router\";\nimport MyTablePagination from \"../../../component/my-pagination/my-pagination\";\nimport { useForm } from \"react-hook-form\";\nimport { Button, Paper, Table, TableBody, TableCell, TableContainer, TableHead, TableRow, Tooltip } from \"@material-ui/core\";\nimport { faPlus } from \"@fortawesome/free-solid-svg-icons\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport IconButton from '@material-ui/core/IconButton';\nimport InputBase from '@material-ui/core/InputBase';\nimport EditIcon from '@material-ui/icons/Edit';\nimport DeleteIcon from '@material-ui/icons/Delete';\nimport SearchIcon from '@material-ui/icons/Search';\nimport { MyCard, MyCardActions, MyCardHeader } from \"../../../component/my-card/my-card\";\nimport { doWithLoggedInUser, renderWithLoggedInUser } from \"../../../lib/login\";\nimport styles from \"./order.module.css\";\nimport { formatTime } from \"../../../utils/func\";\nexport async function getServerSideProps(ctx) {\n  return await doWithLoggedInUser(ctx, ctx => {\n    return loadOrderData(ctx);\n  });\n}\nexport async function loadOrderData(ctx) {\n  // setup data\n  let data = {\n    props: {\n      data: []\n    }\n  };\n  await fetch(process.env.API_HOST + '/api/orders').then(response => response.json()).then(res => {\n    data.props.count = res.meta.pagination.total;\n    res.data.map(item => {\n      data.props.data.push(_objectSpread(_objectSpread({}, item.attributes), {}, {\n        id: item.id\n      }));\n    });\n  });\n  return data;\n}\nexport default function OrderPage(props) {\n  return renderWithLoggedInUser(props, render);\n}\n\nfunction render(props) {\n  var _data$data, _data$data2;\n\n  const {\n    register,\n    handleSubmit,\n    errors\n  } = useForm();\n  let router = useRouter();\n  let {\n    0: data,\n    1: setData\n  } = useState(props);\n  let {\n    0: search,\n    1: setSearch\n  } = useState('');\n  useEffect(() => {\n    setData(props);\n    setSearch(typeof router.query.search === 'undefined' ? '' : q);\n  }, [props]);\n  let page = parseInt(router.query.page) || 0;\n  let limit = parseInt(router.query.limit) || 20;\n  let q = router.query.search || '';\n\n  async function handleChange(event) {\n    const value = event.target.value;\n    setSearch(value);\n  }\n\n  function onSearch(formData) {\n    try {\n      q = formatUrlSearch(search);\n      Router.push(`/cms/order?search=${q}`);\n    } catch (error) {\n      console.log(error);\n    }\n  }\n\n  async function deleteOrder(id) {\n    await fetch(process.env.API_HOST + \"/api/orders/\" + id, {\n      method: 'DELETE'\n    }).then(response => response.json()).then(res => console.log(res));\n    let orderList = [...data.data];\n    setData({\n      data: orderList.filter(v => v.id != id),\n      count: data.count - 1\n    });\n  }\n\n  return __jsx(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 9\n    }\n  }, __jsx(Head, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 87,\n      columnNumber: 13\n    }\n  }, __jsx(\"title\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 17\n    }\n  }, \"Danh s\\xE1ch h\\xF3a \\u0111\\u01A1n\")), __jsx(MyCard, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 13\n    }\n  }, __jsx(MyCardHeader, {\n    title: \"Danh s\\xE1ch h\\xF3a \\u0111\\u01A1n\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 17\n    }\n  }, __jsx(Link, {\n    href: \"/cms/order/new\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 21\n    }\n  }, __jsx(Button, {\n    variant: \"contained\",\n    color: \"primary\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 25\n    }\n  }, __jsx(FontAwesomeIcon, {\n    icon: faPlus,\n    style: {\n      marginRight: 8\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 29\n    }\n  }), \"  Th\\xEAm h\\xF3a \\u0111\\u01A1n\"))), __jsx(MyCardActions, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 17\n    }\n  }, __jsx(Paper, {\n    className: styles.search,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 21\n    }\n  }, __jsx(InputBase, {\n    id: \"q\",\n    name: \"q\",\n    className: styles.input,\n    value: search,\n    autoComplete: \"off\",\n    onChange: handleChange,\n    inputRef: register,\n    onKeyPress: event => {\n      if (event.key === 'Enter') {\n        onSearch();\n      }\n    },\n    placeholder: \"Nh\\u1EADp t\\xEAn h\\xF3a \\u0111\\u01A1n\",\n    inputProps: {\n      'aria-label': 'Nhập tên hóa đơn'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 100,\n      columnNumber: 25\n    }\n  }), __jsx(IconButton, {\n    className: styles.iconButton,\n    \"aria-label\": \"search\",\n    onClick: onSearch,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 116,\n      columnNumber: 25\n    }\n  }, __jsx(SearchIcon, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 118,\n      columnNumber: 29\n    }\n  })))), __jsx(TableContainer, {\n    component: Paper,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 122,\n      columnNumber: 17\n    }\n  }, __jsx(Table, {\n    size: \"small\",\n    \"aria-label\": \"a dense table\",\n    style: {\n      tableLayout: 'fixed'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 123,\n      columnNumber: 21\n    }\n  }, __jsx(\"colgroup\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 124,\n      columnNumber: 25\n    }\n  }, __jsx(\"col\", {\n    width: \"15%\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 125,\n      columnNumber: 29\n    }\n  }), __jsx(\"col\", {\n    width: \"25%\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 126,\n      columnNumber: 29\n    }\n  }), __jsx(\"col\", {\n    width: \"20%\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 127,\n      columnNumber: 29\n    }\n  }), __jsx(\"col\", {\n    width: \"15%\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 128,\n      columnNumber: 29\n    }\n  }), __jsx(\"col\", {\n    width: \"15%\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 129,\n      columnNumber: 29\n    }\n  }), __jsx(\"col\", {\n    width: \"10%\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 130,\n      columnNumber: 29\n    }\n  })), __jsx(TableHead, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 132,\n      columnNumber: 25\n    }\n  }, __jsx(TableRow, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 133,\n      columnNumber: 29\n    }\n  }, __jsx(TableCell, {\n    align: \"left\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 134,\n      columnNumber: 33\n    }\n  }, \"ID\"), __jsx(TableCell, {\n    align: \"left\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 135,\n      columnNumber: 33\n    }\n  }, \"ProductID\"), __jsx(TableCell, {\n    align: \"left\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 136,\n      columnNumber: 33\n    }\n  }, \"S\\u1ED1 l\\u01B0\\u1EE3ng\"), __jsx(TableCell, {\n    align: \"left\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 137,\n      columnNumber: 33\n    }\n  }, \"Th\\u1EDDi gian t\\u1EA1o\"), __jsx(TableCell, {\n    align: \"left\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 138,\n      columnNumber: 33\n    }\n  }, \" T\\u1ED5ng ti\\u1EC1n \"), __jsx(TableCell, {\n    align: \"center\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 139,\n      columnNumber: 33\n    }\n  }, \"Thao t\\xE1c\"))), ((_data$data = data.data) === null || _data$data === void 0 ? void 0 : _data$data.length) > 0 ? __jsx(React.Fragment, null, __jsx(TableBody, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 144,\n      columnNumber: 33\n    }\n  }, (_data$data2 = data.data) === null || _data$data2 === void 0 ? void 0 : _data$data2.map(row => __jsx(TableRow, {\n    key: row.id,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 146,\n      columnNumber: 41\n    }\n  }, __jsx(TableCell, {\n    align: \"left\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 147,\n      columnNumber: 45\n    }\n  }, row.id), __jsx(TableCell, {\n    align: \"left\",\n    className: styles.overflowWrap,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 150,\n      columnNumber: 45\n    }\n  }, row.ProductID), __jsx(TableCell, {\n    align: \"left\",\n    className: styles.overflowWrap,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 153,\n      columnNumber: 45\n    }\n  }, row.Quantity), __jsx(TableCell, {\n    align: \"left\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 156,\n      columnNumber: 45\n    }\n  }, row.PurchaseDate), __jsx(TableCell, {\n    align: \"left\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 157,\n      columnNumber: 45\n    }\n  }, row.Subtotal, \"vn\\u0111\"), __jsx(TableCell, {\n    align: \"center\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 158,\n      columnNumber: 45\n    }\n  }, __jsx(Link, {\n    href: `/cms/order/edit?orderId=${row.id}`,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 159,\n      columnNumber: 49\n    }\n  }, __jsx(\"a\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 160,\n      columnNumber: 53\n    }\n  }, __jsx(Tooltip, {\n    title: \"C\\u1EADp nh\\u1EADt th\\xF4ng tin\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 161,\n      columnNumber: 57\n    }\n  }, __jsx(IconButton, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 162,\n      columnNumber: 61\n    }\n  }, __jsx(EditIcon, {\n    fontSize: \"small\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 163,\n      columnNumber: 65\n    }\n  }))))), __jsx(Tooltip, {\n    title: \"X\\xF3a h\\xF3a \\u0111\\u01A1n\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 168,\n      columnNumber: 49\n    }\n  }, __jsx(IconButton, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 169,\n      columnNumber: 53\n    }\n  }, __jsx(DeleteIcon, {\n    onClick: () => deleteOrder(row.id),\n    fontSize: \"small\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 170,\n      columnNumber: 57\n    }\n  }))))))), \"/ \", __jsx(MyTablePagination, {\n    labelUnit: \"h\\xF3a \\u0111\\u01A1n\",\n    count: data === null || data === void 0 ? void 0 : data.count,\n    rowsPerPage: limit,\n    page: page,\n    onChangePage: (event, page, rowsPerPage) => {\n      Router.push(`/cms/order?page=${page}&limit=${rowsPerPage}&search=${q}`);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 178,\n      columnNumber: 31\n    }\n  })) : __jsx(TableBody, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 189,\n      columnNumber: 33\n    }\n  }, __jsx(TableRow, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 190,\n      columnNumber: 37\n    }\n  }, __jsx(TableCell, {\n    colSpan: 3,\n    align: \"left\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 191,\n      columnNumber: 41\n    }\n  }, data.message)))))));\n}","map":{"version":3,"sources":["/home/hao/Deadline/mhhpm_18_3_final/FE-KTXSHOP-SELLER/pages/cms/order/index.js"],"names":["React","useEffect","useState","Head","Link","Router","useRouter","MyTablePagination","useForm","Button","Paper","Table","TableBody","TableCell","TableContainer","TableHead","TableRow","Tooltip","faPlus","FontAwesomeIcon","IconButton","InputBase","EditIcon","DeleteIcon","SearchIcon","MyCard","MyCardActions","MyCardHeader","doWithLoggedInUser","renderWithLoggedInUser","styles","formatTime","getServerSideProps","ctx","loadOrderData","data","props","fetch","process","env","API_HOST","then","response","json","res","count","meta","pagination","total","map","item","push","attributes","id","OrderPage","render","register","handleSubmit","errors","router","setData","search","setSearch","query","q","page","parseInt","limit","handleChange","event","value","target","onSearch","formData","formatUrlSearch","error","console","log","deleteOrder","method","orderList","filter","v","marginRight","input","key","iconButton","tableLayout","length","row","overflowWrap","ProductID","Quantity","PurchaseDate","Subtotal","rowsPerPage","message"],"mappings":"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","sourcesContent":["\nimport React, { useEffect, useState } from \"react\";\nimport Head from \"next/head\";\nimport Link from \"next/link\";\nimport Router, { useRouter } from \"next/router\";\nimport MyTablePagination from \"../../../component/my-pagination/my-pagination\";\nimport { useForm } from \"react-hook-form\";\nimport {\n    Button, Paper, Table, TableBody,\n    TableCell, TableContainer, TableHead, TableRow, Tooltip\n} from \"@material-ui/core\";\nimport { faPlus } from \"@fortawesome/free-solid-svg-icons\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport IconButton from '@material-ui/core/IconButton';\nimport InputBase from '@material-ui/core/InputBase';\nimport EditIcon from '@material-ui/icons/Edit';\nimport DeleteIcon from '@material-ui/icons/Delete';\nimport SearchIcon from '@material-ui/icons/Search';\nimport { MyCard, MyCardActions, MyCardHeader } from \"../../../component/my-card/my-card\";\nimport { doWithLoggedInUser, renderWithLoggedInUser } from \"../../../lib/login\";\nimport styles from \"./order.module.css\";\nimport { formatTime } from \"../../../utils/func\";\n\nexport async function getServerSideProps(ctx) {\n    return await doWithLoggedInUser(ctx, (ctx) => {\n        return loadOrderData(ctx)\n    })\n}\n\nexport async function loadOrderData(ctx) {\n    // setup data\n    let data = { props: { data: [] } }\n    await fetch(process.env.API_HOST + '/api/orders')\n        .then(response => response.json())\n        .then(res => {\n            data.props.count = res.meta.pagination.total\n            res.data.map(item => {\n                data.props.data.push({ ...item.attributes, id: item.id })\n            })\n        });\n    return data\n}\n\nexport default function OrderPage(props) {\n    return renderWithLoggedInUser(props, render)\n}\n\nfunction render(props) {\n    const { register, handleSubmit, errors } = useForm();\n    let router = useRouter();\n    let [data, setData] = useState(props);\n    let [search, setSearch] = useState('');\n    useEffect(() => {\n        setData(props);\n        setSearch(typeof router.query.search === 'undefined' ? '' : q)\n    }, [props]);\n\n    let page = parseInt(router.query.page) || 0\n    let limit = parseInt(router.query.limit) || 20\n    let q = router.query.search || ''\n\n    async function handleChange(event) {\n        const value = event.target.value;\n        setSearch(value)\n    }\n\n    function onSearch(formData) {\n        try {\n            q = formatUrlSearch(search);\n            Router.push(`/cms/order?search=${q}`);\n        } catch (error) {\n            console.log(error)\n        }\n    }\n\n    async function deleteOrder(id) {\n        await fetch(process.env.API_HOST + \"/api/orders/\" + id, {\n            method: 'DELETE',\n        }).then(response => response.json())\n            .then(res => console.log(res));\n        let orderList = [...data.data]\n        setData({ data: orderList.filter((v) => v.id != id), count: data.count - 1 })\n    }\n\n    return (\n        <div >\n            <Head>\n                <title>Danh sách hóa đơn</title>\n            </Head>\n            <MyCard>\n                <MyCardHeader title=\"Danh sách hóa đơn\">\n                    <Link href=\"/cms/order/new\">\n                        <Button variant=\"contained\" color=\"primary\">\n                            <FontAwesomeIcon icon={faPlus} style={{ marginRight: 8 }} />  Thêm hóa đơn\n                            </Button>\n                    </Link>\n                </MyCardHeader>\n                <MyCardActions>\n                    <Paper className={styles.search}>\n                        <InputBase\n                            id=\"q\"\n                            name=\"q\"\n                            className={styles.input}\n                            value={search}\n                            autoComplete='off'\n                            onChange={handleChange}\n                            inputRef={register}\n                            onKeyPress={event => {\n                                if (event.key === 'Enter') {\n                                    onSearch()\n                                }\n                            }}\n                            placeholder=\"Nhập tên hóa đơn\"\n                            inputProps={{ 'aria-label': 'Nhập tên hóa đơn' }}\n                        />\n                        <IconButton className={styles.iconButton} aria-label=\"search\"\n                            onClick={onSearch}>\n                            <SearchIcon />\n                        </IconButton>\n                    </Paper>\n                </MyCardActions>\n                <TableContainer component={Paper}>\n                    <Table size=\"small\" aria-label=\"a dense table\" style={{ tableLayout: 'fixed' }}>\n                        <colgroup>\n                            <col width=\"15%\" />\n                            <col width=\"25%\" />\n                            <col width=\"20%\" />\n                            <col width=\"15%\" />\n                            <col width=\"15%\" />\n                            <col width=\"10%\" />\n                        </colgroup>\n                        <TableHead>\n                            <TableRow>\n                                <TableCell align=\"left\">ID</TableCell>\n                                <TableCell align=\"left\">ProductID</TableCell>\n                                <TableCell align=\"left\">Số lượng</TableCell>\n                                <TableCell align=\"left\">Thời gian tạo</TableCell>\n                                <TableCell align=\"left\"> Tổng tiền </TableCell>\n                                <TableCell align=\"center\">Thao tác</TableCell>\n                            </TableRow>\n                        </TableHead>\n                        {data.data?.length > 0 ? (\n                            <>\n                                <TableBody>\n                                    {data.data?.map((row) => (\n                                        <TableRow key={row.id}>\n                                            <TableCell align=\"left\">\n                                                {row.id}\n                                            </TableCell>\n                                            <TableCell align=\"left\" className={styles.overflowWrap}>\n                                                {row.ProductID}\n                                            </TableCell>\n                                            <TableCell align=\"left\" className={styles.overflowWrap}>\n                                                {row.Quantity}\n                                            </TableCell>\n                                            <TableCell align=\"left\">{row.PurchaseDate}</TableCell>\n                                            <TableCell align=\"left\">{row.Subtotal}vnđ</TableCell>\n                                            <TableCell align=\"center\">\n                                                <Link href={`/cms/order/edit?orderId=${row.id}`}>\n                                                    <a>\n                                                        <Tooltip title=\"Cập nhật thông tin\">\n                                                            <IconButton>\n                                                                <EditIcon fontSize=\"small\" />\n                                                            </IconButton>\n                                                        </Tooltip>\n                                                    </a>\n                                                </Link>\n                                                <Tooltip title=\"Xóa hóa đơn\">\n                                                    <IconButton>\n                                                        <DeleteIcon onClick={() => deleteOrder(row.id)} fontSize=\"small\" />\n                                                    </IconButton>\n                                                </Tooltip>\n\n                                            </TableCell>\n                                        </TableRow>\n                                    ))}\n                                </TableBody>\n                            / <MyTablePagination\n                                    labelUnit=\"hóa đơn\"\n                                    count={data?.count}\n                                    rowsPerPage={limit}\n                                    page={page}\n                                    onChangePage={(event, page, rowsPerPage) => {\n                                        Router.push(`/cms/order?page=${page}&limit=${rowsPerPage}&search=${q}`)\n                                    }}\n                                />\n                            </>\n                        ) : (\n                                <TableBody>\n                                    <TableRow>\n                                        <TableCell colSpan={3} align=\"left\">{data.message}</TableCell>\n                                    </TableRow>\n                                </TableBody>\n                            )}\n\n                    </Table>\n                </TableContainer>\n            </MyCard>\n        </div >\n    )\n}"]},"metadata":{},"sourceType":"module"}